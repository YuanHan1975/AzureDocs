# Azure存储类型

![1551567937044](assets/1551567937044.png)

# Azure存储账户

## 存储账户概念

![1551567786219](assets/1551567786219.png)



## 创建存储账户

![1551568060654](assets/1551568060654.png)

![1551568186291](assets/1551568186291.png)

- 账户类型：

  ![1551568344981](assets/1551568344981.png)

- 复制：

  ![1551568427966](assets/1551568427966.png)

  *Tips*

  - StorageV1缺少分层等属性
  - StorageV1和BlobStorage可升级到StorageV2

  

![1551568489579](assets/1551568489579.png)

![1551568619085](assets/1551568703624.png)



## 存储账户设置

![1551568997663](assets/1551568997663.png)

### 访问密钥

![1551569120174](assets/1551569120174.png)

- 整个存储账户控制权限
- 默认两个
- 需定期更换

### 异地复制

![1551569260251](assets/1551569260251.png)

### 配置

![1551569297721](assets/1551569297721.png)

### 加密

![1551569335846](assets/1551569335846.png)

### 防火墙和虚拟网络

![1551569420954](assets/1551569420954.png)



# Blob

## 创建Blob容器

![1551610643230](assets/1551610643230.png)

### 容器权限

- 专用：无权限用户无法访问
- Blob：无权限用户可以访问指定Blob
- 容器：无权限用户可以查看容器里Blob的list并访问Blob

创建3个不同权限的容器：

![1551610856738](assets/1551610856738.png)

## 上传Blob

![1551611006071](assets/1551611006071.png)

### Blob类型

![1551611083809](assets/1551611083809.png)

- 块Blob：普通文件
- 页Blob：vhd硬盘镜像，需要512字节对齐
- 追加Blob：只能在文件末尾补充数据

## Blob属性

### URL

![1551612038285](assets/1551612038285.png)

### 访问层

![1551612070583](assets/1551612070583.png)

*Tips*

- 存档层不能直接访问，需要恢复到冷或者热层，需要数小时时间

  ![1551612181400](assets/1551612181400.png)

### 容器权限的验证

将同一个图片传到3个不同权限的容器，并在浏览器打开图片的url，可以看到，有Blob和容器权限的容器里的图片可以打开，专有权限的容器里的图片无法打开

![1551612566209](assets/1551612566209.png)

## Blob设置

### 自定义域

![1551612915992](assets/1551612915992.png)

### 软删除

![1551612956015](assets/1551612956015.png)

#### 启用软删除

![1551613012287](assets/1551613012287.png)

![1551613047001](assets/1551613047001.png)

### CDN

![1551613100383](assets/1551613100383.png)

### 添加Azure搜索

![1551613147272](assets/1551613147272.png)

### 生命周期管理

![1551613172059](assets/1551613172059.png)



# 文件

## 创建文件共享

![1551613270320](assets/1551613270320.png)

*Tips*

- 目前配额最大只支持5120GiB
- 按实际使用容量收费，而非配额
- Global支持备份（预览）

## 连接文件共享

![1551613497463](assets/1551613497463.png)

*Tips*

- 文件服务为SMB3.0
- Linux有最低版本要求，例如CentOS需要7以上
- SMB3.0加密支持跨广域网连接，但是要求445端口开放
- Linux如果要跨广域网连接，有最低版本要求，例如CentOS需要7.5以上

